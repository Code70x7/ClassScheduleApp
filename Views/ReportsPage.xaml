<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ClassScheduleApp.Views.ReportsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Reports">

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="16">

            <!-- ===== SUMMARY CARDS (existing) ===== -->
            <Frame Padding="14" BorderColor="#ddd" HasShadow="False">
                <VerticalStackLayout Spacing="6">
                    <Label Text="Summary" FontAttributes="Bold" FontSize="16"/>
                    <Grid ColumnDefinitions="*,*,*">
                        <VerticalStackLayout>
                            <Label Text="Terms" FontSize="12" TextColor="Gray"/>
                            <Label x:Name="TermsCountLabel" FontAttributes="Bold" FontSize="18"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="Courses" FontSize="12" TextColor="Gray"/>
                            <Label x:Name="CoursesCountLabel" FontAttributes="Bold" FontSize="18"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="2">
                            <Label Text="Open To-Dos" FontSize="12" TextColor="Gray"/>
                            <Label x:Name="OpenTodosLabel" FontAttributes="Bold" FontSize="18"/>
                        </VerticalStackLayout>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <Frame Padding="14" BorderColor="#ddd" HasShadow="False">
                <VerticalStackLayout Spacing="6">
                    <Label Text="Assessments by Type" FontAttributes="Bold" FontSize="16"/>
                    <Grid ColumnDefinitions="*,*,*">
                        <VerticalStackLayout>
                            <Label Text="OA" FontSize="12" TextColor="Gray"/>
                            <Label x:Name="OaCountLabel" FontAttributes="Bold" FontSize="18"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="PA" FontSize="12" TextColor="Gray"/>
                            <Label x:Name="PaCountLabel" FontAttributes="Bold" FontSize="18"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="2">
                            <Label Text="Tests" FontSize="12" TextColor="Gray"/>
                            <Label x:Name="TestCountLabel" FontAttributes="Bold" FontSize="18"/>
                        </VerticalStackLayout>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <Frame Padding="14" BorderColor="#ddd" HasShadow="False">
                <VerticalStackLayout Spacing="6">
                    <Label Text="Recent Assessments" FontAttributes="Bold" FontSize="16"/>
                    <CollectionView x:Name="RecentAssessments" HeightRequest="180">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="6" ColumnDefinitions="*,Auto">
                                    <VerticalStackLayout>
                                        <Label Text="{Binding Title}" FontAttributes="Bold"/>
                                        <Label FontSize="12" Text="{Binding Type}"/>
                                        <Label FontSize="12"
                                               Text="{Binding EndDate, StringFormat='Ends: {0:MMM d, yyyy}'}"/>
                                    </VerticalStackLayout>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- ===== NEW: TERMS REPORT (table) ===== -->
            <Frame Padding="14" BorderColor="#ddd" HasShadow="False">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Terms Report" FontAttributes="Bold" FontSize="18"/>
                    <Label x:Name="TermsReportGeneratedAt" FontSize="12" TextColor="Gray"/>
                    <!-- Header -->
                    <Grid ColumnDefinitions="2*,*,*,Auto" Padding="6,4" BackgroundColor="#F5F5F5">
                        <Label Text="Term" FontAttributes="Bold"/>
                        <Label Grid.Column="1" Text="Start" FontAttributes="Bold"/>
                        <Label Grid.Column="2" Text="End" FontAttributes="Bold"/>
                        <Label Grid.Column="3" Text="# Courses" FontAttributes="Bold" HorizontalTextAlignment="End"/>
                    </Grid>
                    <!-- Rows -->
                    <CollectionView x:Name="TermsReportList">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="2*,*,*,Auto" Padding="6,8" >
                                    <Label Text="{Binding Term}" LineBreakMode="TailTruncation"/>
                                    <Label Grid.Column="1"
                                           Text="{Binding Start, StringFormat='{0:MMM d, yyyy}'}"/>
                                    <Label Grid.Column="2"
                                           Text="{Binding End, StringFormat='{0:MMM d, yyyy}'}"/>
                                    <Label Grid.Column="3"
                                           Text="{Binding CourseCount}"
                                           HorizontalTextAlignment="End"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- ===== NEW: COURSES REPORT (table) ===== -->
            <Frame Padding="14" BorderColor="#ddd" HasShadow="False">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Courses Report" FontAttributes="Bold" FontSize="18"/>
                    <Label x:Name="CoursesReportGeneratedAt" FontSize="12" TextColor="Gray"/>
                    <Grid ColumnDefinitions="2*,*,*,*,*" Padding="6,4" BackgroundColor="#F5F5F5">
                        <Label Text="Course" FontAttributes="Bold"/>
                        <Label Grid.Column="1" Text="Term" FontAttributes="Bold"/>
                        <Label Grid.Column="2" Text="Status" FontAttributes="Bold"/>
                        <Label Grid.Column="3" Text="Start" FontAttributes="Bold"/>
                        <Label Grid.Column="4" Text="End" FontAttributes="Bold"/>
                    </Grid>
                    <CollectionView x:Name="CoursesReportList">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="2*,*,*,*,*" Padding="6,8">
                                    <Label Text="{Binding Course}" LineBreakMode="TailTruncation"/>
                                    <Label Grid.Column="1" Text="{Binding Term}" LineBreakMode="TailTruncation"/>
                                    <Label Grid.Column="2" Text="{Binding Status}"/>
                                    <Label Grid.Column="3" Text="{Binding Start, StringFormat='{0:MMM d, yyyy}'}"/>
                                    <Label Grid.Column="4" Text="{Binding End, StringFormat='{0:MMM d, yyyy}'}"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- ===== NEW: TO-DOs REPORT (table) ===== -->
            <Frame Padding="14" BorderColor="#ddd" HasShadow="False">
                <VerticalStackLayout Spacing="8">
                    <Label Text="To-Dos Report" FontAttributes="Bold" FontSize="18"/>
                    <Label x:Name="TodosReportGeneratedAt" FontSize="12" TextColor="Gray"/>
                    <Grid ColumnDefinitions="2*,*,*,Auto" Padding="6,4" BackgroundColor="#F5F5F5">
                        <Label Text="Task" FontAttributes="Bold"/>
                        <Label Grid.Column="1" Text="Course" FontAttributes="Bold"/>
                        <Label Grid.Column="2" Text="Due" FontAttributes="Bold"/>
                        <Label Grid.Column="3" Text="Done" FontAttributes="Bold" HorizontalTextAlignment="End"/>
                    </Grid>
                    <CollectionView x:Name="TodosReportList">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="2*,*,*,Auto" Padding="6,8">
                                    <Label Text="{Binding Task}" LineBreakMode="TailTruncation"/>
                                    <Label Grid.Column="1" Text="{Binding Course}" LineBreakMode="TailTruncation"/>
                                    <Label Grid.Column="2"
                                           Text="{Binding Due, StringFormat='{0:MMM d, yyyy}'}"/>
                                    <Label Grid.Column="3"
                                           Text="{Binding Completed}"
                                           HorizontalTextAlignment="End"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
