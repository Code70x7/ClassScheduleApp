<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ClassScheduleApp.Views.CoursesPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Courses">

    <!-- ========= RESOURCES ========= -->
    <ContentPage.Resources>
        <!-- Gradients to match TermDetailPage -->
        <LinearGradientBrush x:Key="PurpleGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#7C4DFF" Offset="0.0" />
            <GradientStop Color="#5B2DFF" Offset="1.0" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="TealGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#00C9A7" Offset="0.0" />
            <GradientStop Color="#0097B2" Offset="1.0" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="DangerGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF4B5C" Offset="0.0" />
            <GradientStop Color="#8C2BFF" Offset="1.0" />
        </LinearGradientBrush>

        <!-- Shadow resource -->
        <Shadow x:Key="CardShadow"
                Brush="Black"
                Opacity="0.25"
                Radius="6"
                Offset="0,3" />

        <!-- Shared gradient button style -->
        <Style x:Key="GradientButton" TargetType="Button">
            <Setter Property="TextColor" Value="White" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="CornerRadius" Value="20" />
            <Setter Property="HeightRequest" Value="46" />
            <Setter Property="Padding" Value="20,12" />
            <Setter Property="Shadow" Value="{StaticResource CardShadow}" />
        </Style>
    </ContentPage.Resources>

    <!-- ========= PAGE BODY ========= -->
    <Grid Padding="16" RowDefinitions="Auto,Auto,*" RowSpacing="12">

        <!-- Header shows the selected Term -->
        <Label x:Name="TermHeader"
               Grid.Row="0"
               FontSize="18"
               FontAttributes="Bold"
               Text="Term" />

        <!-- Add course -->
        <Button x:Name="AddCourseBtn"
                Grid.Row="1"
                Text="Add Course"
                Clicked="AddCourse_Clicked"
                Background="{StaticResource TealGradient}"
                Style="{StaticResource GradientButton}" />

        <!-- Course list -->
        <CollectionView
            x:Name="CoursesCollection"
            Grid.Row="2"
            SelectionMode="Single"
            SelectionChanged="OnCourseSelected"
            Margin="0,4,0,0">

            <CollectionView.EmptyView>
                <Label Text="No courses yet. Tap 'Add Course' to create one."
                       HorizontalOptions="Center"
                       TextColor="#777"
                       FontSize="14"
                       Margin="0,10" />
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border StrokeShape="RoundRectangle 16"
                            StrokeThickness="0"
                            BackgroundColor="#F7F8FA"
                            Margin="0,6"
                            Padding="12">

                        <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
                            <!-- Course info -->
                            <VerticalStackLayout Spacing="4">
                                <Label Text="{Binding Title}" FontAttributes="Bold" />
                                <Label FontSize="12"
                                       Text="{Binding StartDate, StringFormat='Start: {0:MMM d, yyyy}'}"/>
                                <Label FontSize="12"
                                       Text="{Binding EndDate, StringFormat='End: {0:MMM d, yyyy}'}"/>
                                <Label FontSize="12" Text="{Binding Status}" />
                            </VerticalStackLayout>

                            <!-- Edit -->
                            <Button Grid.Column="1"
                                    Text="Edit"
                                    CommandParameter="{Binding .}"
                                    Clicked="EditCourse_Clicked"
                                    Background="{StaticResource PurpleGradient}"
                                    Style="{StaticResource GradientButton}"
                                    WidthRequest="80" />

                            <!-- Delete -->
                            <Button Grid.Column="2"
                                    Text="Delete"
                                    CommandParameter="{Binding .}"
                                    Clicked="DeleteCourse_Clicked"
                                    Background="{StaticResource DangerGradient}"
                                    Style="{StaticResource GradientButton}"
                                    WidthRequest="80" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>
