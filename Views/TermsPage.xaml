<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ClassScheduleApp.Views.TermsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Academic Terms">

    <!-- ===== Resources ===== -->
    <ContentPage.Resources>

        <!-- Gradients -->
        <LinearGradientBrush x:Key="PurpleGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#7C4DFF" Offset="0.0" />
            <GradientStop Color="#5B2DFF" Offset="1.0" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="DangerGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF4B5C" Offset="0.0" />
            <GradientStop Color="#8C2BFF" Offset="1.0" />
        </LinearGradientBrush>

        <!-- Shadow resource (Setter can't parse a tuple) -->
        <Shadow x:Key="CardShadow"
                Brush="Black"
                Opacity="0.25"
                Radius="6"
                Offset="0,3" />

        <!-- Shared gradient button style -->
        <Style x:Key="GradientButton" TargetType="Button">
            <Setter Property="TextColor" Value="White" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="CornerRadius" Value="20" />
            <Setter Property="HeightRequest" Value="40" />
            <Setter Property="Shadow" Value="{StaticResource CardShadow}" />
            <Setter Property="Padding" Value="16,10" />
        </Style>

    </ContentPage.Resources>

    <!-- ===== Body ===== -->
    <Grid Padding="16" RowDefinitions="Auto,*" RowSpacing="12">

        <!-- Add Term -->
        <Button Grid.Row="0"
                Text="Add Term"
                Clicked="AddTerm_Clicked"
                Background="{StaticResource PurpleGradient}"
                Style="{StaticResource GradientButton}" />

        <!-- Terms list -->
        <CollectionView Grid.Row="1"
                        x:Name="TermsCollection"
                        SelectionMode="Single"
                        SelectionChanged="ClearSelection"
                        Margin="0,4,0,0">

            <CollectionView.EmptyView>
                <Label Text="No terms yet. Tap 'Add Term' to create one."
                       HorizontalOptions="Center"
                       TextColor="#777"
                       FontSize="14"
                       Margin="0,10" />
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border StrokeShape="RoundRectangle 16"
                            StrokeThickness="0"
                            BackgroundColor="#F7F8FA"
                            Margin="0,6"
                            Padding="12">

                        <Grid RowDefinitions="Auto,Auto"
                              ColumnDefinitions="*,Auto,Auto,Auto"
                              ColumnSpacing="8">

                            <!-- Title + dates (null-safe + plain text to avoid span crashes) -->
                            <VerticalStackLayout Grid.Row="0" Grid.ColumnSpan="4" Spacing="2">
                                <Label TextType="Text"
                                       Text="{Binding Title, TargetNullValue='', FallbackValue=''}"
                                       FontAttributes="Bold"
                                       FontSize="16" />
                                <Label TextType="Text"
                                       FontSize="12"
                                       Text="{Binding StartDate, StringFormat='{0:MMM d, yyyy}', TargetNullValue='', FallbackValue=''}"/>
                                <Label TextType="Text"
                                       FontSize="12"
                                       Text="{Binding EndDate, StringFormat='{0:MMM d, yyyy}', TargetNullValue='', FallbackValue=''}"/>
                            </VerticalStackLayout>

                            <!-- Row actions -->
                            <!-- Courses button with the turquoiseâ†’purple gradient -->
                            <Button Grid.Row="1" Grid.Column="1"
                                    Text="Courses"
                                    CommandParameter="{Binding .}"
                                    Clicked="OpenCourses_Clicked"
                                    WidthRequest="96"
                                    TextColor="White"
                                    CornerRadius="20"
                                    Padding="14,6"
                                    Style="{StaticResource GradientButton}">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#00C9A7" Offset="0.0" />
                                        <GradientStop Color="#6C63FF" Offset="1.0" />
                                    </LinearGradientBrush>
                                </Button.Background>
                            </Button>

                            <Button Grid.Row="1" Grid.Column="2"
                                    Text="Edit"
                                    CommandParameter="{Binding .}"
                                    Clicked="EditTerm_Clicked"
                                    Background="{StaticResource PurpleGradient}"
                                    Style="{StaticResource GradientButton}"
                                    WidthRequest="80" />

                            <Button Grid.Row="1" Grid.Column="3"
                                    Text="Delete"
                                    CommandParameter="{Binding .}"
                                    Clicked="DeleteTerm_Clicked"
                                    Background="{StaticResource DangerGradient}"
                                    Style="{StaticResource GradientButton}"
                                    WidthRequest="90" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentPage>
